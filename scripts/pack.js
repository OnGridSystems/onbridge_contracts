const { ethers } = require("hardhat");

const PROXY_WITH_SENDER = 2;
const REVERT_IF_EXTERNAL_FAIL = 1;
const flags = 2 ** REVERT_IF_EXTERNAL_FAIL + 2 ** PROXY_WITH_SENDER;

function packSubmissionAutoParamsTo(
  executionFee,
  flags,
  fallbackAddress,
  data
) {
  const autoParams = { executionFee, flags, fallbackAddress, data };
  const packed = ethers.utils.defaultAbiCoder.encode(
    [
      {
        type: "tuple",
        name: "SubmissionAutoParamsTo",
        components: [
          { name: "executionFee", type: "uint256" },
          { name: "flags", type: "uint256" },
          { name: "fallbackAddress", type: "bytes" },
          { name: "data", type: "bytes" },
        ],
      },
    ],
    [autoParams]
  );
  return packed;
}

const executionFee = "30000000000000000";
const fallbackAddress = "0x44B8326616C2a7Ac37A2d2719E067d5aA8DaD0ba";

/*
Function: finalizeInboundTransfer(address _to, string _l1Tx, uint256 _id) ***

MethodID: 0xd72ce90e
[0]:  000000000000000000000000cd794cd1c83ed8cb15000e2fb4386477801b2c92
[1]:  0000000000000000000000000000000000000000000000000000000000000060
[2]:  0000000000000000000000000000000000000000000000000000000000000003
[3]:  0000000000000000000000000000000000000000000000000000000000000001
[4]:  2000000000000000000000000000000000000000000000000000000000000000
*/

const data =
  "0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000180000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000022eb87ddfd552b8e7cb774a6e039c6aa4b699e3a00000000000000000000000000000000000000000000000000000000000000140b73c9260e4456b5b0295401ebf5274fbb4c560400000000000000000000000000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000006a94d74f4300000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000140b73c9260e4456b5b0295401ebf5274fbb4c56040000000000000000000000000000000000000000000000000000000000000000000000000000000000000084d72ce90e000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb9226600000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";

const ethersPack = packSubmissionAutoParamsTo(
  executionFee,
  flags,
  fallbackAddress,
  data
);

console.log(ethersPack);
/*
0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000006a94d74f4300000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000001444b8326616c2a7ac37a2d2719e067d5aa8dad0ba00000000000000000000000000000000000000000000000000000000000000000000000000000000000000a4d72ce90e000000000000000000000000cd794cd1c83ed8cb15000e2fb4386477801b2c92000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
*/
